 <!DOCTYPE html>
<html>
  <head>
    <title>carro_Maria Valentina Gómez Urbina Cód: 600393</title>
    <style>
      html, body { margin: 0; padding: 0; overflow: hidden; }
        #info {
                position: absolute;
                padding: 10px;
                width: 100%;
                text-align: center;
                color: 'white';
            }
    </style>
  </head>
  <body>
      <div id="info">
			Parcial segundo corte<br/>
            Valentina Gomez <br/>
            600393 <br/>
        </div>
    <script src="js/three.js"></script>
	<script src="js/controls/OrbitControls.js"></script>
    <script>
		var aspect, controls;
        var scene = new THREE.Scene();
        var camera = new THREE.PerspectiveCamera(50, winW / winH, 0.01, 10);
        var renderer = new THREE.WebGLRenderer({antialias: true});
renderer.setSize(winW, winH);
document.body.appendChild(renderer.domElement);
        var winW=window.innerWidth;
        var winH = window.innerHeight;
        var radius = 4;
        var height = 5;
	
		init();
		animate();
	
		function init(){
			scene = new THREE.Scene();
			aspect = window.innerWidth / window.innerHeight;
			camera = new THREE.PerspectiveCamera( 45, aspect, 0.1, 1000);
			renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );

			controls = new THREE.OrbitControls( camera, renderer.domElement );			
			
			var size = 10;
			var arrowSize = 1;
			var divisions = size;
			var origin = new THREE.Vector3( 0, 0, 0 );
			var x = new THREE.Vector3( 1, 0, 0 );
			var y = new THREE.Vector3( 0, 1, 0 );
		  	var z = new THREE.Vector3( 0, 0, 1 );
			var color1 = new THREE.Color( 0xFFFFFF );
		  	var color2 = new THREE.Color( 0x333333 );
		  	var colorR = new THREE.Color( 0xAA3333 );
		  	var colorG = new THREE.Color( 0x33AA00 );
		  	var colorB = new THREE.Color( 0x333366 );
		  
		  	//CREAR LAS GRILLAS PARA EL ESCENARIO
		  	var axesHelper = new THREE.AxesHelper( size );
		  	var gridHelperXY = new THREE.GridHelper( size, divisions, color1, color1);
		  	var gridHelperXZ = new THREE.GridHelper( size, divisions, color2, color2 );
		  	var gridHelperYZ = new THREE.GridHelper( size, divisions, color2, color2 );
            
            //ROTARLAS PARA QUE QUEDEN EN EL ESPACIO ADECUADO
            gridHelperXY.rotateOnWorldAxis ( x, THREE.Math.degToRad(90) );
            gridHelperXZ.rotateOnWorldAxis ( y, THREE.Math.degToRad(90) );
            gridHelperYZ.rotateOnWorldAxis ( z, THREE.Math.degToRad(90) );
            
            //CREAR LAS FLECHAS QUE INDICAN LOS EJES DE COORDENADAS 3D
            var arrowX = new THREE.ArrowHelper( x, origin, arrowSize, colorR );
            var arrowY = new THREE.ArrowHelper( y, origin, arrowSize, colorG );
            var arrowZ = new THREE.ArrowHelper( z, origin, arrowSize, colorB );
            
            
            //ILUMINACION 
			
			var hemisphereLight = new THREE.HemisphereLight(0xfffafa,0x000000, .9)
			scene.add(hemisphereLight);
			sun = new THREE.DirectionalLight( 0xcdc1c5, 0.9);
			sun.position.set( 20,-10,20 );
			sun.castShadow = true;
			scene.add(sun);
            
             //extrusion
            
			var pointLight1 = new THREE.PointLight( 0xffffff, .2, 0 );
            pointLight1.position.set( 10, 10, -10);
            scene.add( pointLight1 );
			
			var pointLight2 = new THREE.PointLight( 0xffffff, .5, 100 );
            pointLight2.position.set( 20, 20, 20 );
            scene.add( pointLight2 );
            
            var curve2D = [];
             
                curve2D[0] = new THREE.Vector3( -20, 0 );
                curve2D[1] = new THREE.Vector2( -20, 2.5 );
                curve2D[2] = new THREE.Vector2( -20.5, 3.5 );
                curve2D[3] = new THREE.Vector2( -22, 5 );
				curve2D[4] = new THREE.Vector2( -22.5, 5.5 );
                curve2D[5] = new THREE.Vector2( -24.5, 6 );
                curve2D[6] = new THREE.Vector2( -27.5, 6);
                curve2D[7] = new THREE.Vector2( -29.5, 5.5 );
				curve2D[8] = new THREE.Vector2( -32.5, 4.5 );
                curve2D[9] = new THREE.Vector2( -34, 3 );
                curve2D[10] = new THREE.Vector2( -38, 0 );
                curve2D[11] = new THREE.Vector2( -41, 4 );
				curve2D[12] = new THREE.Vector2( -42, 6 );
                curve2D[13] = new THREE.Vector2( -42, 7);
                curve2D[14] = new THREE.Vector2( -41, 7.5 );
                curve2D[15] = new THREE.Vector2( -29.5, 9 );
				curve2D[16] = new THREE.Vector2( -17, 11.5 );
                curve2D[17] = new THREE.Vector2( -6, 13 ); //Segunda parte
                curve2D[18] = new THREE.Vector2( 6, 7 );
                curve2D[19] = new THREE.Vector2( 9, 7.5 );
		curve2D[20] = new THREE.Vector2( 12, 7 );
                curve2D[21] = new THREE.Vector2( 11, 6 );
                curve2D[22] = new THREE.Vector2( 12, 5 );
                curve2D[23] = new THREE.Vector2( 14.5, 4 );// frente del carro
		curve2D[24] = new THREE.Vector2( 15.5, 3 );//frente punta parte baja
                curve2D[25] = new THREE.Vector2( 10, 0)//punto antes de la curva de la primera llanta
                curve2D[26] = new THREE.Vector2( 8, 0 );
                curve2D[27] = new THREE.Vector2( 7, 2.5 );
		curve2D[28] = new THREE.Vector2(5, 5);
                curve2D[29] = new THREE.Vector2( -8, 5 );
                curve2D[30] = new THREE.Vector2(-8.5, 2.5 );
                curve2D[31] = new THREE.Vector2( -7, 1.5 );
		curve2D[32] = new THREE.Vector2( -7, 0 );
		curve2D[33] = new THREE.Vector2( -7, 0 );
				
			var shape = new THREE.Shape();
			shape.moveTo(0,0,);
            
			shape.splineThru(curve2D);

            var materialcarro = new THREE.LineBasicMaterial( { color : 0xAA3333 } );
            var resolution = 50;
            var points = shape.getPoints(resolution);
            var geometrycar = new THREE.BufferGeometry().setFromPoints( points );
			curveObject= new THREE.Line (geometrycar, materialcarro);
			
			//EXTRUDE
			
			var extrudeSettings = {
				steps: 3 ,
				amount: 26,
				bevelEnabled: false,
                //bevelSegments: 2,
                //bevelSize: 1, 
                //bevelThickness: 1,
			};

			var geometryExt = new THREE.ExtrudeGeometry( shape, extrudeSettings );
			var materialExt= new THREE.MeshStandardMaterial( { 
				color: 'purple', 
				metalness: 0.5, 
				roughness: 0.1,
				opacity: 8,
				transparent: true			
			} );
			
			carro = new THREE.Mesh( geometryExt, materialExt ) ;
            
            carro.position.z=-13;
            //carrito.applyMatrix( new THREE.Matrix4().makeScale(1.8,1.5,1) );
            
			scene.add( carro );
            
			//CREAR LAS GEOMETRÍAS
            
            
            //llanta completa
            
            var textureLlanta = new THREE.TextureLoader().load('gomallanta.jpg');
            var materialLLanta = new THREE.MeshBasicMaterial({ map: textureLlanta });
            var radius=5;
            var tubeRadius=2;
            var radialSegments = 8;  
            var tubularSegments = 24;  
            var geometryLlanta = new THREE.TorusBufferGeometry(radius, tubeRadius,radialSegments, tubularSegments);
            var llanta = new THREE.Mesh(geometryLlanta, materialLLanta);
            var llanta2 = new THREE.Mesh(geometryLlanta, materialLLanta);
            var llanta3 = new THREE.Mesh(geometryLlanta, materialLLanta);
            var llanta4 = new THREE.Mesh(geometryLlanta, materialLLanta);
            
            
            llanta2.position.z=-15;
            llanta.position.z=15;
            llanta3.position.x=-30;
            llanta3.position.z=-15;
            llanta4.position.x=-30;
            llanta4.position.z=15;
            
            scene.add(llanta4);
            scene.add(llanta2);
            scene.add(llanta3);
            scene.add(llanta);
            
            //partes internas de la llanta
            var textureacero = new THREE.TextureLoader().load('acero.jpg');
            var geometry = new THREE.PlaneBufferGeometry( 2.5, 2.5, 6 );
            
            var material = new THREE.MeshBasicMaterial( {map: textureacero, side: THREE.DoubleSide} );
            var plane = new THREE.Mesh( geometry, material );
            var plane2 = new THREE.Mesh( geometry, material );
            var plane3 = new THREE.Mesh( geometry, material );
            var plane4 = new THREE.Mesh( geometry, material );
            var plane5 = new THREE.Mesh( geometry, material );
            var plane6 = new THREE.Mesh( geometry, material );
            var plane7 = new THREE.Mesh( geometry, material );
            var plane8 = new THREE.Mesh( geometry, material );
            var plane9 = new THREE.Mesh( geometry, material );
            var plane10 = new THREE.Mesh( geometry, material );
            var plane11 = new THREE.Mesh( geometry, material );
            var plane12 = new THREE.Mesh( geometry, material );
            var plane13 = new THREE.Mesh( geometry, material );
            var plane14 = new THREE.Mesh( geometry, material );
            var plane15 = new THREE.Mesh( geometry, material );
            var plane16 = new THREE.Mesh( geometry, material );
            
            //mover las posiciones para que quedenacordes a la figura
            
            plane.position.x=2;
            plane.position.y=2;
            plane.position.z=15;
            plane2.position.x=2;
            plane2.position.y=-2;
            plane2.position.z=15;
            plane3.position.x=-2;
            plane3.position.y=-2;
            plane3.position.z=15;
            plane4.position.x=-2;
            plane4.position.y=2;
            plane4.position.z=15;
            
            plane5.position.x=2;
            plane5.position.y=2;
            plane5.position.z=-15;
            plane6.position.x=2;
            plane6.position.y=-2;
            plane6.position.z=-15;
            plane7.position.x=-2;
            plane7.position.y=-2;
            plane7.position.z=-15;
            plane8.position.x=-2;
            plane8.position.y=2;
            plane8.position.z=-15;
            
            plane9.position.x=-32;
            plane9.position.y=2;
            plane9.position.z=-15;
            plane10.position.x=-28;
            plane10.position.y=-2;
            plane10.position.z=-15;
            plane11.position.x=-32;
            plane11.position.y=-2;
            plane11.position.z=-15;
            plane12.position.x=-28;
            plane12.position.y=2;
            plane12.position.z=-15;
            
            plane13.position.x=-32;
            plane13.position.y=2;
            plane13.position.z=15;
            plane14.position.x=-28;
            plane14.position.y=-2;
            plane14.position.z=15;
            plane15.position.x=-32;
            plane15.position.y=-2;
            plane15.position.z=15;
            plane16.position.x=-28;
            plane16.position.y=2;
            plane16.position.z=15;
            
            //agregar la figura a la escena
            
            scene.add( plane );
            scene.add( plane2 );
            scene.add( plane3 );
            scene.add( plane4 );
            scene.add( plane5 );
            scene.add( plane6 );
            scene.add( plane7 );
            scene.add( plane8 );
            scene.add( plane9 );
            scene.add( plane10 );
            scene.add( plane11 );
            scene.add( plane12 );
            scene.add( plane13 );
            scene.add( plane14 );
            scene.add( plane15 );
            scene.add( plane16 );
            
            //vidrios
            var geometryvidrios = new THREE.PlaneBufferGeometry(  25, 10,
    7, 5);
             var geometryvidrios2 = new THREE.PlaneBufferGeometry(  10, 4.6,
    7, 5);
            
            var vidrio= new THREE.Mesh(geometryvidrios,material);
            scene.add(vidrio);
            var vidrio2= new THREE.Mesh(geometryvidrios2,material);
            var vidrio3= new THREE.Mesh(geometryvidrios2,material);
            scene.add(vidrio);
            scene.add(vidrio2);
            scene.add(vidrio3);
            
            vidrio2.position.y=9;
            vidrio2.position.x=-10;
            vidrio2.position.z=14;
            vidrio3.position.y=9;
            vidrio3.position.x=-10;
            vidrio3.position.z=-14;
            vidrio.position.y=11;
            vidrio.position.x=-24;
         
            //vidrio.rotateY(-150);
            vidrio.rotation.y=-Math.PI/2;
            vidrio.rotation.set(1.57,0.5, 1.57);
            //vidrio.rotation.x=-Math.PI/4;
            //vidrio.rotation.z=Math.PI/4;
            //vidrio.rotateX(30);
            
            
            
            //bordes metalicos llanta
        
            var radius2=5;
            var tubeRadius2=2;
            var radialSegments2 = 8;  
            var tubularSegments2 = 10;  
            var geometrytoroide = new THREE.TorusBufferGeometry(radius2, tubeRadius2,radialSegments2, tubularSegments2);
            var toroidecentral = new THREE.Mesh(geometrytoroide, material);
            var toroidecentral2 = new THREE.Mesh(geometrytoroide, material);
            var toroidecentral3 = new THREE.Mesh(geometrytoroide, material);
            var toroidecentral4 = new THREE.Mesh(geometrytoroide, material);
            
            toroidecentral.position.z=15;
            toroidecentral2.position.z=-15;
            toroidecentral3.position.z=15;
            toroidecentral3.position.x=-30;
            toroidecentral4.position.x=-30;
            toroidecentral4.position.z=-15;
            
           scene.add(toroidecentral);
           scene.add(toroidecentral2);
           scene.add(toroidecentral3);
           scene.add(toroidecentral4);

            // circulo del centro
            
            var innerRadius = 0.5; 
            var outerRadius = 1.5;  // ui: outerRadius
            var thetaSegments = 18;  // ui: thetaSegments
            var geometrycirculo = new THREE.RingBufferGeometry(innerRadius, outerRadius, thetaSegments);
            var circulo = new THREE.Mesh(geometrycirculo, material);
            var circulo2 = new THREE.Mesh(geometrycirculo, material);
            var circulo3 = new THREE.Mesh(geometrycirculo, material);
            var circulo4 = new THREE.Mesh(geometrycirculo, material);
            
            circulo2.position.z=-15;
            circulo.position.z=15;
            circulo3.position.z=-15;
            circulo3.position.x=-30;
            circulo4.position.x=-30;
            circulo4.position.z=15;
            
            scene.add(circulo4);
            scene.add(circulo3);
            scene.add(circulo2);
            scene.add(circulo);
            //camara posicion
            
            camera.position.z = -90;
            camera.position.x = 50;
        camera.position.y= 70;    
            
            
            
           
		  	scene.add( arrowX );	
		  	scene.add( arrowY );	
		  	scene.add( arrowZ );	
			
		
			}//
    
    function animate() {
        render();
		controls.update();
        requestAnimationFrame( animate );
        }
    
    function render(){
		var tx=0, ty=0, tz=0;	//Variables para traslacion
		var sc = 1;				//Variable para escala
		var theta=0;			//Variable para ángulo de rotacion de piernas
		var sigma=0;			//Variable para ángulo de rotación de caderas
		
		if(thetaSum>=60*Math.PI/180)
			positivo = false;
		if(thetaSum<=-60*Math.PI/180)
			positivo = true;
		
		if(upArrow) {
			tx=0; ty=0; tz=.1;
			if(positivo)
				theta = .1;
			else
				theta = -.1;
		}
		if(downArrow) {
			tx=0; ty=0; tz=-.1;
			if(positivo)
				theta = .1;
			else
				theta = -.1;
		}
		thetaSum+=theta;
		
		if(rightArrow)
			sigma = -.1;
		if(leftArrow)
			sigma = .1;
		
		//MATRIZ DE TRASLACIÓN
		var t = new THREE.Matrix4();
		t.set( 	1, 0, 0, tx,
				0, 1, 0, ty, 
				0, 0, 1, tz,
				0, 0, 0, 1	);
		
		hips.matrix.multiply(t); 	//APLICAR LA TRASLACIÓN A NIVEL LOCAL
		
		//ROTACIONES
		var ct1 = Math.cos(theta);
		var ct2 = Math.cos(-theta);
		var cs = Math.cos(sigma);
		var st1 = Math.sin(theta);
		var st2 = Math.sin(-theta);
		var ss = Math.sin(sigma);
		var r = new THREE.Matrix4();
		var r1 = new THREE.Matrix4();
		var r2 = new THREE.Matrix4();
		
		//MATRIZ DE ROTACIÓN EN EJE Y
		r.set( 	   cs,  0, ss, 0,
					0,  1,  0, 0, 
				  -ss,  0, cs, 0,
					0,  0,  0, 1 );	
		//MATRICES DE ROTACIÓN EN EJE LOCAL DE PIERNAS	
		r1.set( 	1,  0,  0, 0,
					0, ct1,-st1, 0, 
					0, st1, ct1, 0,
					0,  0,  0, 1 );	
		r2.set( 	1,  0,  0, 0,
					0, ct2,-st2, 0, 
					0, st2, ct2, 0,
					0,  0,  0, 1 );							
					
		
		//ROTACION EN UN EJE PARALELO
		var tempMatrix = new THREE.Matrix4();
		tempMatrix.copyPosition( hips.matrix );
		hips.applyMatrix( new THREE.Matrix4().getInverse(tempMatrix) );
		hips.applyMatrix(r);
		hips.applyMatrix( tempMatrix );

        
        
    }
    
    function render(){
        renderer.render( scene, camera );
    }
    </script>
  </body>
</html>